// This is a lot of code, jeez